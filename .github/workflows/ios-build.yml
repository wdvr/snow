name: iOS Build

# Uses shared workflow from ios-infra for building the iOS app

on:
  push:
    branches:
      - main
    paths:
      - 'ios/**'
      - '.github/workflows/ios-build.yml'
  pull_request:
    branches:
      - main
    paths:
      - 'ios/**'
  workflow_dispatch:

concurrency:
  group: ios-build-${{ github.ref }}
  cancel-in-progress: true

jobs:
  build:
    uses: wdvr/ios-infra/.github/workflows/ios-build.yml@main
    with:
      bundle_id: com.wouterdevriendt.snowtracker
      scheme: SnowTracker
      project_path: ios/SnowTracker.xcodeproj
      use_xcodegen: true
      xcodegen_path: ios
      info_plist_path: ios/SnowTracker/Info.plist
      additional_info_plists: 'ios/SnowTrackerWidget/Info.plist'
      skip_automatic_signing: false
    secrets: inherit
